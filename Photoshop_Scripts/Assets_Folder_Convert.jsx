/* * Assets_Folder_Convert.jsx Wed Jul 15 2015 10:17:37 GMT+0800 * * Copyright (c) 2015 Ashung Hung (mailto:Ashung.hung@gmail.com) *  * Licensed under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * *    http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. * */(function(){    'use strict'    var iOSAssetName = [            [/\.(png|gif|jpg|svg)$/i, 1],            [/@1\.5x\.(png|gif|jpg|svg)$/i, 1.5],            [/@2x\.(png|gif|jpg|svg)$/i, 2],            [/@3x\.(png|gif|jpg|svg)$/i, 3],            [/@4x\.(png|gif|jpg|svg)$/i, 4]        ],        androidResFolder = [            ['drawable-mdpi', 1],            ['drawable-hdpi', 1.5],            ['drawable-xhdpi', 2],            ['drawable-xxhdpi', 3],            ['drawable-xxxhdpi', 4]        ];    var ui = "dialog {\            text: 'Assets Folder Convert',\            alignChildren: 'fill',\            assetsFolder: Group {\                orientation: 'column',\                alignChildren: 'left', \                label: StaticText { text: 'Assets Folder:' },\                folderFormItem: Group {\                    orientation: 'row',\                    folderText: EditText {\                        size: [230, 25] \                    },\                    folderBrowser: Button { \                        text: 'Browser...', \                        size: [80, 25] \                    }\                }\            },\            separator: Panel { preferredSize: [260, 0] },\            androidBtn: Button {\                size: [260, 25], \                text: 'iOS Assets Folder -> Android Res Folder'\            },\            iOSBtn: Button {\                size: [260, 25],\                text: 'Android Res Folder -> iOS Assets Folder'\            },\            cancelBtn: Button {\                size: [260, 25],\                text: 'Cancel'\            }\        }";    var dialog = new Window(ui);           var assetsFolder = dialog.assetsFolder.folderFormItem.folderText;        assetsFolder.text = Folder.desktop.fullName;    var assetsBrowser = dialog.assetsFolder.folderFormItem.folderBrowser;        assetsBrowser.onClick = function() {            var f = Folder(assetsFolder.text).selectDlg('Select the folder you wannt to convert:');            if(f != null) {                assetsFolder.text = f.fullName;            }        }    dialog.androidBtn.onClick = function() {        assetFromIOSToAndroid(assetsFolder.text);    }    dialog.iOSBtn.onClick = function() {        assetFromAndroidToIOS(assetsFolder.text);    }    dialog.show();    function assetFromIOSToAndroid(dir) {        for(var i = iOSAssetName.length - 1; i >= 0; i --) {            var assets = Folder(dir).getFiles();            if(assets == null) {                return;            }            for(var j = 0; j < assets.length; j ++) {                if(iOSAssetName[i][0].test(assets[j].name)) {                                        var resFolder = assets[j].parent + '/' + androidResFolder[i][0];                    if(!Folder(resFolder).exists) {                        Folder(resFolder).create();                    }                                        assets[j].copy(File(resFolder + '/' + assets[j].name.replace(/@(1.5|2|3|4)x/i, '')));                    assets[j].remove();                                        // $.writeln(assets[j].name + ' -> ' + androidResFolder[i][0] + '/' + assets[j].name.replace(/@(1.5|2|3|4)x/i, ''));                }            }        }    }    function assetFromAndroidToIOS(dir) {        for(var i = 0; i < androidResFolder.length; i ++) {            var assets = Folder(dir + '/' + androidResFolder[i][0]).getFiles();            if(assets == null) {                return;            }            for(var j = 0; j < assets.length; j ++) {                if(/\.(png|gif|jpg|svg)$/i.test(assets[j].name)) {                                        var suffix = (androidResFolder[i][1] > 1) ? ('@' + androidResFolder[i][1] + 'x') : '';                    assets[j].copy(File(dir + '/' + assets[j].name.replace(/\./, suffix + '.')));                    assets[j].remove();                                        // $.writeln(androidResFolder[i][0] + '/' + assets[j].name + ' -> ' + assets[j].name.replace(/\./, '.' + suffix));                }            }                        if(Folder(dir + '/' + androidResFolder[i][0]).getFiles().length == 0) {                Folder(dir + '/' + androidResFolder[i][0]).remove();            }        }    }     })();