/* * Copyright (c) 2015 Ashung Hung (mailto:Ashung.hung@gmail.com) *  * Licensed under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * *    http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. * * Project Home: https://github.com/Ashung/GUI_Automation_Toolbox * ****************************************************************************** * * PNG Image Log *  * Create image logs for psd file veryday. * * HOW TO USE: * 1, Open 'File' - 'Scripts' - 'Script Events Manager...' dialog.  * 2, Check the 'Enable Events to Run Scripts/Actions:'. * 3, In 'Photoshop Event' choose 'Save Document' event. * 4, check 'Script' radiobox and browse to Png_Image_Log.jsx. * 5, Press 'Add'. * */(function main(){    var ext = /\./.test(activeDocument.name)                 ? activeDocument.name.substr(activeDocument.name.lastIndexOf('.') + 1, activeDocument.name.length)                 : '';        if(ext.toLowerCase() == ('psd' || 'psb' || '')) {        var name = activeDocument.name.replace(/\.(psd|psb)$/i, '')                    .replace(/ /g, '_')                    .toLowerCase();                var path = Folder.desktop;        try {            path = activeDocument.path;        } catch(e) {}        var date = new Date();        var year = date.getFullYear();        var month = date.getMonth() < 9 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1;        var day = date.getDate() < 10 ? '0' + date.getDate() : date.getDate();        var dateString = year + '_' + month + '_' + day;                var saveFile = new File(path + "/" + name + '_' + dateString + ".png");                var pngSaveOptions = new PNGSaveOptions();            pngSaveOptions.compression = 9;            pngSaveOptions.interlaced = false;        activeDocument.saveAs(saveFile, pngSaveOptions, true, Extension.LOWERCASE);    }})();