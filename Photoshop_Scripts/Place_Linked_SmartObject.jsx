/* * Copyright (c) 2015 Ashung Hung (mailto:Ashung.hung@gmail.com) *  * Licensed under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * *    http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. * *//* * Project Home: https://github.com/Ashung/GUI_Automation_Toolbox */(function(){    'use strict'        var ui =         "dialog {\            text: 'Place Linked Smart Object',\            alignChildren: 'fill',\            labelFiles: StaticText { text: 'Select files:' },\            pathBrowser: Button { \                size: [300, 40],\                text: 'Browser...' \            },\            labelDimension: StaticText { text: 'Resize to:' },\            dimensions: Group { \                orientation: 'row',\                percentage: EditText {\                    size: [50, 25],\                    text: 100\                },\                labelDimen1: StaticText { text: '%' }\            }, \            separator1: Panel { preferredSize: [300, 0] },\            buttons: Group {\                orientation: 'row',\                cancelBtn: Button {\                    alignment: ['right', 'center'], \                    text: 'Cancel'\                },\                runBtn: Button {\                    alignment: ['right', 'center'], \                    text: 'OK'\                }\            }\        }";    var PLS = new Window(ui);    var browser = PLS.pathBrowser;    var images;        browser.onClick = function() {              images = File.openDialog('Select Images', 'PNG:*.png; JPG:*.jpg; PSD:*.psd', true);        if(images) {            browser.text += ' (' + images.length + ' files)';        }    }    var percentage = PLS.dimensions.percentage;    PLS.buttons.runBtn.onClick = function() {        this.enabled = false;                for(var i = 0; i < images.length; i ++) {            PlaceLinked(images[i]);            if(percentage.text) {                activeDocument.activeLayer.resize(percentage.text, percentage.text, AnchorPosition.TOPLEFT);            }        }        PLS.close();    }    PLS.show();        function PlaceLinked(targetFile) {        var idPlc = charIDToTypeID("Plc ");        var desc1 = new ActionDescriptor();        var idnull = charIDToTypeID("null");            desc1.putPath(idnull, targetFile);        var idLnkd = charIDToTypeID("Lnkd");            desc1.putBoolean(idLnkd, true);        var idFTcs = charIDToTypeID("FTcs");        var idQCSt = charIDToTypeID("QCSt");        var idQcszero = charIDToTypeID("Qcs0");            desc1.putEnumerated(idFTcs, idQCSt, idQcszero);            executeAction(idPlc, desc1, DialogModes.NO);    }    })();